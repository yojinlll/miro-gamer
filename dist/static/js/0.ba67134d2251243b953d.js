webpackJsonp([0],{"3lXq":function(t,i){},"5zde":function(t,i,n){n("zQR9"),n("qyJz"),t.exports=n("FeBl").Array.from},Gu7T:function(t,i,n){"use strict";i.__esModule=!0;var e,s=n("c/Tr"),a=(e=s)&&e.__esModule?e:{default:e};i.default=function(t){if(Array.isArray(t)){for(var i=0,n=Array(t.length);i<t.length;i++)n[i]=t[i];return n}return(0,a.default)(t)}},Mhyx:function(t,i,n){var e=n("/bQp"),s=n("dSzd")("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||a[s]===t)}},"c/Tr":function(t,i,n){t.exports={default:n("5zde"),__esModule:!0}},dY0y:function(t,i,n){var e=n("dSzd")("iterator"),s=!1;try{var a=[7][e]();a.return=function(){s=!0},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,i){if(!i&&!s)return!1;var n=!1;try{var a=[7],r=a[e]();r.next=function(){return{done:n=!0}},a[e]=function(){return r},t(a)}catch(t){}return n}},fBQ2:function(t,i,n){"use strict";var e=n("evD5"),s=n("X8DO");t.exports=function(t,i,n){i in t?e.f(t,i,s(0,n)):t[i]=n}},msXi:function(t,i,n){var e=n("77Pl");t.exports=function(t,i,n,s){try{return s?i(e(n)[0],n[1]):i(n)}catch(i){var a=t.return;throw void 0!==a&&e(a.call(t)),i}}},nUSM:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=n("Gu7T"),s=n.n(e),a=(n("U/rD"),n("JnRc")),r=n.n(a).a.User.current(),o={name:"goods-unpaid",data:function(){return{unpaidList:null,paidList:null,indexActive:null,timerId:null}},computed:{allSelected:{get:function(){if(this.unpaidList&&this.unpaidList.length)return this.unpaidList.every(function(t){return t.select})},set:function(t){this.unpaidList&&this.unpaidList.length&&this.unpaidList.forEach(function(i){i.select=t})}},goodsTotal:function(){var t=0;return this.unpaidList&&this.unpaidList.length&&this.unpaidList.forEach(function(i){i.select&&(t+=+i.price*i.number)}),t},amount:function(){var t=[];return this.unpaidList&&this.unpaidList.length&&this.unpaidList.forEach(function(i){i.select&&t.unshift(i)}),t.length}},mounted:function(){this.getCartList(),this.getPaidList()},methods:{getCartList:function(){var t=this;r.attributes.cart?this.unpaidList=r.attributes.cart:this.unpaidList=[],this.unpaidList.forEach(function(i){t.$set(i,"select",!1)})},getPaidList:function(){this.paidList=r.attributes.paid,this.paidList||(this.paidList=[])},selectGoods:function(t){t.select=!t.select},selectAllGoods:function(){this.allSelected=!this.allSelected},removeGoods:function(){var t=[];this.unpaidList&&this.unpaidList.length&&(t=this.unpaidList.filter(function(t){return!t.select})),this.unpaidList=t,this.updateLeanCloudCart()},goProduct:function(t){location.href="category.html#/product?id="+t},changeGoodsNumber:function(t,i,n){var e=this;"reduce"===i?this.unpaidList.forEach(function(i){if(i===t)if(i.number>1)i.number--;else if(1===i.number){var n=e.unpaidList.indexOf(i);e.unpaidList.splice(n,1)}}):"add"===i&&this.unpaidList.forEach(function(i){i===t&&i.number++}),this.updateLeanCloudCart().then(function(){e.onTips(n,300)})},updateLeanCloudCart:function(){return r.set("cart",this.unpaidList),r.save()},onTips:function(t,i){var n=this;this.timerId&&window.clearTimeout(this.timerId),this.timerId=setTimeout(function(){n.indexActive=t,n.timerId=null,setTimeout(function(){n.indexActive=null},i+500)},i)},onPay:function(){var t=[],i=[];this.unpaidList&&this.unpaidList.length&&this.unpaidList.forEach(function(n){if(n.select){var e=new Date;n.time=e.toLocaleString(),n.receive=!1,n.evaluate=!1,n.evaluateText="",t.unshift(n)}else i.unshift(n)}),this.paidList=[].concat(t,s()(this.paidList)),this.unpaidList=i,r.set("cart",this.unpaidList),r.set("paid",this.paidList),r.save()}}},u={render:function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("div",{staticClass:"goods-unpaid-wrapper"},[n("ul",t._l(t.unpaidList,function(i,e){return n("li",{key:i.productId,staticClass:"goods-item"},[n("span",{staticClass:"select-button",class:{select:!0===i.select},on:{click:function(n){return t.selectGoods(i)}}}),t._v(" "),n("img",{attrs:{src:i.img[0],alt:"goods"}}),t._v(" "),n("span",{staticClass:"item-goods-name",on:{click:function(n){return t.goProduct(i.productId)}}},[t._v("\n              "+t._s(i.name)+"\n            ")]),t._v(" "),n("div",{staticClass:"item-part"},[n("div",{staticClass:"item-goods-actions"},[n("span",{staticClass:"action-button",on:{click:function(n){return t.changeGoodsNumber(i,"reduce",e)}}},[t._v("-")]),t._v(" "),n("input",{attrs:{type:"text",readonly:""},domProps:{value:i.number}}),t._v(" "),n("span",{staticClass:"action-button",on:{click:function(n){return t.changeGoodsNumber(i,"add",e)}}},[t._v("+")])]),t._v(" "),n("div",{staticClass:"item-goods-price"},[t._v("\n          ￥"+t._s(i.price.toFixed(2))+"\n        ")])]),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.indexActive===e?n("div",{staticClass:"tips"},[t._v("save")]):t._e()])],1)}),0),t._v(" "),t.unpaidList&&0===t.unpaidList.length?n("div",{staticClass:"placeholder"},[t._v("空")]):t._e(),t._v(" "),n("div",{staticClass:"action-bar"},[n("div",{staticClass:"action-bar-button"},[n("span",{staticClass:"select-button",class:{select:!0===t.allSelected},on:{click:t.selectAllGoods}}),t._v(" "),n("span",[t._v("全选")]),t._v(" "),n("span",{staticClass:"remove",on:{click:t.removeGoods}},[t._v("删除")])]),t._v(" "),n("div",{staticClass:"select-info"},[t._v("\n      ("+t._s(t.amount)+"件)合计：\n      "),0!=t.goodsTotal?n("span",{staticClass:"total"},[t._v("￥"+t._s(t.goodsTotal.toFixed(2)))]):n("span",[t._v("0")])]),t._v(" "),n("div",{staticClass:"pay",on:{click:t.onPay}},[t._v("\n      结算\n    ")])])])},staticRenderFns:[]};var c=n("VU/8")(o,u,!1,function(t){n("3lXq")},"data-v-7371b821",null);i.default=c.exports},qyJz:function(t,i,n){"use strict";var e=n("+ZMJ"),s=n("kM2E"),a=n("sB3e"),r=n("msXi"),o=n("Mhyx"),u=n("QRG4"),c=n("fBQ2"),d=n("3fs2");s(s.S+s.F*!n("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var i,n,s,l,f=a(t),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,L=void 0!==v,m=0,_=d(f);if(L&&(v=e(v,h>2?arguments[2]:void 0,2)),void 0==_||p==Array&&o(_))for(n=new p(i=u(f.length));i>m;m++)c(n,m,L?v(f[m],m):f[m]);else for(l=_.call(f),n=new p;!(s=l.next()).done;m++)c(n,m,L?r(l,v,[s.value,m],!0):s.value);return n.length=m,n}})}});
//# sourceMappingURL=0.ba67134d2251243b953d.js.map